set(PACKAGE_PATH ${SHEEP_PROJECT_SOURCE_DIR}/src/extends/small_pprof)
FIND_PATH(small_pprof_INCLUDE_DIRS small_pprof.h ${PACKAGE_PATH}/)
IF (APPLE) 
    FIND_LIBRARY(GPERFHTTPD_LIBRARIES libgperftools-httpd.a PATH ${PACKAGE_PATH}/build)
    FIND_LIBRARY(PROFILE_LIBRARIES libprofiler.a PATH ${PACKAGE_PATH}/build)
    FIND_LIBRARY(TCMALLOC_LIBRARIES libtcmalloc.a PATH ${PACKAGE_PATH}/build)
    SET (small_pprof_LIBRARIES ${GPERFHTTPD_LIBRARIES} 
    ${PROFILE_LIBRARIES} ${TCMALLOC_LIBRARIES})
ELSE (APPLE)
    SET(GPERFHTTPD_LIBRARIES ${PACKAGE_PATH}/build/libgperftools-httpd.a)
    FIND_LIBRARY(UNWIND_LIBRARIES libunwind.a PATH ${PACKAGE_PATH}/build)
    FIND_LIBRARY(LZMA_LIBRARIES liblzma.a PATH ${PACKAGE_PATH}/build)
    SET(UNWIND_LIBRARIES ${UNWIND_LIBRARIES} ${LZMA_LIBRARIES})
    SET(TCMALLOC_PROFILE_LIBRARIES ${PACKAGE_PATH}/build/libtcmalloc_and_profiler.a)
    SET (small_pprof_LIBRARIES ${GPERFHTTPD_LIBRARIES}
        ${TCMALLOC_PROFILE_LIBRARIES} ${UNWIND_LIBRARIES})
    MESSAGE("${small_pprof_LIBRARIES}")
ENDIF (APPLE)

IF (small_pprof_INCLUDE_DIRS AND GPERFHTTPD_LIBRARIES AND TCMALLOC_PROFILE_LIBRARIES AND UNWIND_LIBRARIES)
	SET(small_pprof_FOUND TRUE)
ENDIF (small_pprof_INCLUDE_DIRS AND GPERFHTTPD_LIBRARIES AND TCMALLOC_PROFILE_LIBRARIES AND UNWIND_LIBRARIES)
IF (small_pprof_FOUND)
    IF (NOT small_pprof_FIND_QUIETLY)
        MESSAGE(STATUS "Found small_pprof: ${small_pprof_LIBRARIES}")
    ENDIF (NOT small_pprof_FIND_QUIETLY)
ELSE (small_pprof_FOUND)
    IF (small_pprof_FIND_REQUIRED)
        MESSAGE(FATAL_ERROR "Could not find small_pprof library")
    ENDIF (small_pprof_FIND_REQUIRED)
ENDIF (small_pprof_FOUND)
